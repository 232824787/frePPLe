{% extends "admin/base_site_nav.html" %}
{% load i18n admin_list adminmedia %}
{% block extrahead %}{{ block.super }}
{% for js in javascript_imports %}<script type="text/javascript" src="{{js}}"></script>
{% endfor %}
<script type="text/javascript">
		ContextMenu.setup();
		ContextMenu.attach('item', 'itemcontext');
</script>
{% endblock %}
{% block stylesheet %}{% admin_media_prefix %}css/changelists.css{% endblock %}
{% block coltype %}colM{% endblock %}
{% block tools %}<div class="tools">
<a href="{% addurlparameter type csv %}" title="Export as CSV"><img src="/static/csv.png"/></a>
</div>{% endblock %}{% block content %}
<div id="content-main">

<div id="itemcontext" class="ContextMenu">
{% if perms.input.change_item %}<a id="/admin/input/item/%s/">Item</a>{% endif %}
<a id="/supplypath/item/%s/">Supply Path</a>
<a id="/whereused/item/%s/">Where Used</a>
<a id="/demand/%s/">Demand</a>
</div>

<div style="overflow-x: scroll; overflow-y: auto;">
<table><thead><tr>{{ rowheader }}{{ columnheader }}</tr></thead>

<tbody>{% for j in objectlist %}{% ifchanged j.item %}{% if not forloop.first %}</tr>{% endif %}
<tr class="{% cycle row1,row2 %}" id="{{j.item|urlencode}}"><td>{{j.item|superlink:"item"}}</td>
<td>{{ crossheader }}</td>{% endifchanged %}
<!-- @todo not possible to filter on item yet... -->
<td>{% if j.demand %}<a href="/demandplan/?o=4a&amp;duedate__gte={{j.startdate}}&amp;duedate__lt={{j.enddate}}">{{j.demand|floatformat:1}}</a>{% else %}0.0{% endif %}<br/>
{% if j.supply %}<a href="/demandplan/?o=5a&amp;plandate__gte={{j.startdate}}&amp;plandate__lt={{j.enddate}}">{{j.supply|floatformat:1}}</a>{% else %}0.0{% endif %}<br/>
{{j.backlog|floatformat:1}}</td>
{% if forloop.last %}</tr>{% endif %}{% endfor %}
</tbody></table>
</div>

{% block pagination %} <p class="paginator">
{% if is_paginated %}
{% for x in page_htmls %} {{x}} {% endfor %}
{% endif %}
&nbsp;&nbsp;{{hits}} items {% ifnotequal hits fullhits %} (total <a class="showall" href="/demand/">{{fullhits}}</a>){% endifnotequal %}
</p>{% endblock %}

</div>
{% endblock %}
