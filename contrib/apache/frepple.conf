#
# file     : $URL: file:///develop/SVNrepository/frepple/trunk/test/runtest.pl $
# revision : $LastChangedRevision$  $LastChangedBy$
# date     : $LastChangedDate$
# email    : jdetaeye@users.sourceforge.net
#
# Copyright (C) 2006 by Johan De Taeye
#
# This library is free software; you can redistribute it and/or modify it 
# under the terms of the GNU Lesser General Public License as published   
# by the Free Software Foundation; either version 2.1 of the License, or  
# (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser 
# General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA 
#

# IMPORTANT:
# This file contains a bare-bone Apache configuration for running the
# Frepple module.
# It is by no means intended to be complete. You will need to update the
# settings to meet your taste and requirements.

# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default.
Listen 8000
User johan

# Root directory 
DocumentRoot "/home/johan/workspace/frepple/contrib/apache/htdocs"

# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
ServerAdmin you@frepple.sourceforge.net

# Make sure we have a correct MPM in the server
<IfModule prefork.c>
  Error: Your Apache server isn't compiled with a correct MPM.
  Frepple absolutely requires a threaded MPM!
</IfModule>

# Make sure only 1 process is created!!!
# If multiple processes are created they will each have their own copy of the
# frepple data... The settings below are fine for the MPM's "worker" and 
# "win_nt". Other MPM's may need different settings.
# Only 1 process allowed
ServerLimit         1 
# Create 20 threads in the server
# Depending on the MPM used, Apache creates a fixed set of threads or
# dynamically creates and destroys them.
ThreadLimit         20
MaxClients          20
ThreadsPerChild     20
MaxSpareThreads     20
# The child process shouldn't die
MaxRequestsPerChild 0

# A minimum set of Apache modules
# Modules that are linked statically in the executable are commented out
# but are still required for proper operation.
#LoadModule dir_module /usr/lib/httpd/modules/mod_dir.so
#LoadModule log_config_module /usr/lib/httpd/modules/mod_log_config.so
#LoadModule deflate_module /usr/lib/httpd/modules/mod_deflate.so
#LoadModule headers_module /usr/lib/httpd/modules/mod_headers.so
#LoadModule mime_module /usr/lib/httpd/modules/mod_mime.so
LoadModule frepple_module /home/johan/workspace/frepple/contrib/apache/mod_frepple.so

# Configure the logfiles
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b" frepple
CustomLog /home/johan/workspace/frepple/contrib/apache/access.log frepple
ErrorLog /home/johan/workspace/frepple/contrib/apache/error.log

# Configure a user friendly error page
ErrorDocument 404 /missing.html

# Frepple application directives
FreppleHome /home/johan/workspace/frepple/bin

# Allow multiple requests to be served over a single connection.
# This should provide better performance for the static content.
KeepAlive On 

# Static files are handled from this directory
<Directory "/">
  DirectoryIndex index.html 
  Options Indexes FollowSymLinks
  AllowOverride None
  # Request to cache the static content for 3 hours
  # Note: The caching is a real nightmare when you are making changes to the
  # static pages and need to debug something. 
  #Header append Cache-Control max-age=10800
</Directory>

# This handler takes care of report generation
# The relative path to the directory with the static content is important.
<Location /reports>
  #FreppleMethod REPORT
  # Compress the xml data. This setting is optional but highly recommended. 
  # The compression drastically reduces the network traffic for the request.
  # A compression ratio of 10 is typically achieved.
  SetOutputFilter DEFLATE
  # Handle all requests on this request with the frepple module
  SetHandler frepple
</Location>

# This handler is used for uploading updates to the application
# The relative path to the directory with the static content is important.
<Location /upload>
  FreppleMethod UPLOAD
  SetOutputFilter DEFLATE
  SetHandler frepple
</Location>

# This handler is used for uploading updates to the application
# The relative path to the directory with the static content is important.
<Location /cmd>
  FreppleMethod COMMAND /home/johan/workspace/frepple/contrib/apache/htdocs/data
  SetHandler frepple
</Location>

# Access to the documentation pages
Alias /doc /home/johan/workspace/frepple/doc

