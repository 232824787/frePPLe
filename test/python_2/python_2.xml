<?xml version="1.0" encoding="UTF-8" ?>
<plan xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <description>
    This test case tests the embedded python interpreter.
  </description>
  <current>2007-01-01T00:00:00</current>
<?python
import frepple

def printmodel():
  '''This function prints out information about the model to the output file'''

  # Open the file
  out = open("output.1.xml", "wt", 1)

  # Print information
  try:
    print "start exporting the problems"
    print >>out, "Problems:"
    for i in frepple.problem():
      print >>out, i["entity"], i["type"], i["start"], i["end"], \
        i["description"]

    print "start exporting the operation plans"
    print >>out, "\nOperationplans:"
    for i in frepple.operationplan():
      print >>out, i["identifier"], i["operation"], i["quantity"], \
        i["start"], i["end"], i["demand"]

    print "start exporting the buffer plans"
    print >>out, "\nBuffers:"
    for i in frepple.buffer():
      print >>out, i["name"], i["category"], i["subcategory"], \
        i["description"], i["onhand"], i["location"], i["item"], \
        i["maximum"], i["producing"]
      for j in i["flowplans"]:
        print >>out, "     ", j["buffer"], j["operationplan"], \
          j["quantity"], j["date"], j["onhand"]

    print "start exporting the resource plans"
    print >>out, "\nResources:"
    for i in frepple.resource():
      print >>out, i["name"], i["category"], i["subcategory"], \
        i["description"], i["location"], i["maximum"], i["owner"]
      for j in i["loadplans"]:
        print >>out, "     ", j["resource"], j["operationplan"], \
          j["quantity"], j["startdate"], j["enddate"]

    print "start exporting the demand plans"
    print >>out, "\nDemands:"
    for i in frepple.demand():
      print >>out, i["name"], i["quantity"], i["due"], i["priority"], \
        i["item"], i["operation"], i["owner"], i["customer"]

    print "Done"

  # Close the file
  finally:
    out.close()
?>
  <commands>
  	<verbose>true</verbose>
  	<abortonerror>false</abortonerror>

  	<!-- Read an XML file. -->
    <command xsi:type="command_python">
      <cmdline>frepple.readXMLfile(&quot;data.xml&quot;)</cmdline>
    </command>
    <command xsi:type="command_python" cmdline="printmodel()" />
    <command xsi:type="command_size"/>
    <!-- Process XML string. -->
    <!-- The XML string executes a command to run the solver. -->
    <command xsi:type="command_python">
      <cmdline>
<![CDATA[
frepple.readXMLdata('''<?xml version="1.0" encoding="UTF-8" ?>
<plan xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><commands>
  <command xsi:type="command_solve" verbose="false">
    <solver name="MRP" xsi:type="solver_mrp" constraints="7" />
  </command>
</commands></plan>
''')
]]>
      </cmdline>
    </command>
    <command xsi:type="command_size"/>

  	<!-- Print information to the output file. -->
    <command xsi:type="command_python" cmdline="printmodel()" />
    <command xsi:type="command_size"/>

  	<!-- Save the model to an XML file. -->
    <command xsi:type="command_python" cmdline="frepple.saveXMLfile(&quot;output.2.xml&quot;)" />
    <command xsi:type="command_size"/>

  </commands>
</plan>
