<?xml version="1.0" encoding="UTF-8" ?>
<PLAN xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NAME>Forecast test model</NAME>
  <DESCRIPTION>
  This test verifies how actual orders consume from the forecast.
  It shows netting from earlier and later time buckets.
  </DESCRIPTION>
  <CURRENT>2007-01-01T00:00:00</CURRENT>
  <COMMANDS>
    <VERBOSE>true</VERBOSE>
    <COMMAND xsi:type="COMMAND_SOLVE">
      <SOLVER NAME="Netting orders from forecast" xsi:type="SOLVER_FORECAST">
        <VERBOSE>true</VERBOSE>
        <AUTOMATIC>false</AUTOMATIC>
      </SOLVER>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_SOLVE">
      <SOLVER NAME="MRP" xsi:type="SOLVER_MRP" CONSTRAINTS="0" />
    </COMMAND>
    <COMMAND xsi:type="COMMAND_SAVE">
      <FILENAME>output.1.xml</FILENAME>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_SAVEPLAN">
      <FILENAME>output.2.xml</FILENAME>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_ERASE" MODE="model" />
    <COMMAND xsi:type="COMMAND_SAVE">
      <FILENAME>output.3.xml</FILENAME>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_READXML">
      <FILENAME>output.1.xml</FILENAME>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_READXMLSTRING">
      <!--
      We need to wrap the second forecast netting round in a xml string.
      That's because the solver created during the initial read is
      deleted with the above erase-command...
      -->
      <DATA>
        <![CDATA[
				<PLAN xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
				<COMMANDS>
          <COMMAND xsi:type="COMMAND_SOLVE">
            <SOLVER NAME="Netting orders from forecast" xsi:type="SOLVER_FORECAST">
              <VERBOSE>true</VERBOSE>
              <AUTOMATIC>false</AUTOMATIC>
            </SOLVER>
          </COMMAND>
				</COMMANDS>
				</PLAN>
			]]>
      </DATA>
    </COMMAND>
    <COMMAND xsi:type="COMMAND_SAVE">
      <FILENAME>output.4.xml</FILENAME>
    </COMMAND>

  </COMMANDS>

  <!--
  This calendar defines how forecast values are disaggregated from the
  -->
  <CALENDARS>
    <CALENDAR NAME="planningbuckets" xsi:type="CALENDAR_FLOAT">
      <BUCKETS>
        <!--
          The value for saturday and sunday is set to zero.
          The forecast is only alllowed on weekdays.
        -->
        <!--
          The weight for a monday is higher than a friday.
          This can be used to model situations where more orders are
          expected to be shipped on monday than on fridays.
          Another usage may be to model cases where a peak of orders is
          expected for delivery near the end of a month.
          The weights model the ordering profile of the customers.
        -->
        <BUCKET START="2007-01-01T00:00:00" NAME="Mon Jan 01" VALUE="1.2"/>
        <BUCKET START="2007-01-02T00:00:00" NAME="Tue Jan 02" VALUE="1"/>
        <BUCKET START="2007-01-03T00:00:00" NAME="Wed Jan 03" VALUE="1"/>
        <BUCKET START="2007-01-04T00:00:00" NAME="Thu Jan 04" VALUE="1"/>
        <BUCKET START="2007-01-05T00:00:00" NAME="Fri Jan 05" VALUE="0.8"/>
        <BUCKET START="2007-01-06T00:00:00" NAME="Sat Jan 06" VALUE="0"/>
        <BUCKET START="2007-01-07T00:00:00" NAME="Sun Jan 07" VALUE="0"/>
        <BUCKET START="2007-01-08T00:00:00" NAME="Mon Jan 08" VALUE="1.2"/>
        <BUCKET START="2007-01-09T00:00:00" NAME="Tue Jan 09" VALUE="1"/>
        <BUCKET START="2007-01-10T00:00:00" NAME="Wed Jan 10" VALUE="1"/>
        <BUCKET START="2007-01-11T00:00:00" NAME="Thu Jan 11" VALUE="1"/>
        <BUCKET START="2007-01-12T00:00:00" NAME="Fri Jan 12" VALUE="0.8"/>
        <BUCKET START="2007-01-13T00:00:00" NAME="Sat Jan 13" VALUE="0"/>
        <BUCKET START="2007-01-14T00:00:00" NAME="Sun Jan 14" VALUE="0"/>
        <BUCKET START="2007-01-15T00:00:00" NAME="Mon Jan 15" VALUE="1.2"/>
        <BUCKET START="2007-01-16T00:00:00" NAME="Tue Jan 16" VALUE="1"/>
        <BUCKET START="2007-01-17T00:00:00" NAME="Wed Jan 17" VALUE="1"/>
        <BUCKET START="2007-01-18T00:00:00" NAME="Thu Jan 18" VALUE="1"/>
        <BUCKET START="2007-01-19T00:00:00" NAME="Fri Jan 19" VALUE=".8"/>
        <BUCKET START="2007-01-20T00:00:00" NAME="Sat Jan 20" VALUE="0"/>
        <BUCKET START="2007-01-21T00:00:00" NAME="Sun Jan 21" VALUE="0"/>
        <!--
          The value of the weekly buckets is set to 5/7 to account for
          the unavailable saturday and sunday.
        -->
        <BUCKET START="2007-01-22T00:00:00" NAME="Week 04" VALUE="0.7142857"/>
        <BUCKET START="2007-01-29T00:00:00" NAME="Week 05" VALUE="0.7142857"/>
        <BUCKET START="2007-02-05T00:00:00" NAME="Week 06" VALUE="0.7142857"/>
        <BUCKET START="2007-02-12T00:00:00" NAME="Week 07" VALUE="0.7142857"/>
        <BUCKET START="2007-02-19T00:00:00" NAME="Week 08" VALUE="0.7142857"/>
        <BUCKET START="2007-02-26T00:00:00" NAME="Week 09" VALUE="0.7142857"/>
        <BUCKET START="2007-03-05T00:00:00" NAME="Week 10" VALUE="0.7142857"/>
        <BUCKET START="2007-03-12T00:00:00" NAME="Week 11" VALUE="0.7142857"/>
        <BUCKET START="2007-03-19T00:00:00" NAME="Week 12" VALUE="0.7142857"/>
        <BUCKET START="2007-03-26T00:00:00" NAME="Week 13" VALUE="0.7142857"/>
        <BUCKET START="2007-04-02T00:00:00" NAME="Week 14" VALUE="0.7142857"/>
        <BUCKET START="2007-04-09T00:00:00" NAME="Week 15" VALUE="0.7142857"/>
        <BUCKET START="2007-04-16T00:00:00" NAME="Week 16" VALUE="0.7142857"/>
        <BUCKET START="2007-04-23T00:00:00" NAME="Week 17" VALUE="0.7142857"/>
        <BUCKET START="2007-04-30T00:00:00" NAME="Week 18" VALUE="0.7142857"/>
        <BUCKET START="2007-05-07T00:00:00" NAME="Week 18" VALUE="0.7142857"/>
      </BUCKETS>
    </CALENDAR>
  </CALENDARS>

  <ITEMS>
    <ITEM NAME="Product 1">
      <OPERATION NAME="delivery 1" xsi:type="OPERATION_FIXED_TIME">
        <DURATION>24:00:00</DURATION>
      </OPERATION>
    </ITEM>
  </ITEMS>

  <DEMANDS>
    <DEMAND NAME="Forecast 1" xsi:type="DEMAND_FORECAST">
      <ITEM NAME="Product 1" />
      <PRIORITY>1</PRIORITY>
      <CALENDAR NAME="planningbuckets" />
      <BUCKETS>
        <BUCKET>
          <START>2007-01-01T00:00:00</START>
          <END>2007-01-29T00:00:00</END>
          <!-- 4 weeks with 5 working days per week, expecting an average
          forecast of 20 per working day. -->
          <TOTAL>400</TOTAL>
        </BUCKET>
      </BUCKETS>
    </DEMAND>
    <DEMAND NAME="Order 1 for product 1">
       <ITEM NAME="Product 1"/>
       <DUE>2007-01-03T00:00:00</DUE>
       <QUANTITY>90</QUANTITY>
       <PRIORITY>1</PRIORITY>
    </DEMAND>
    <DEMAND NAME="Order 2 for product 1">
       <ITEM NAME="Product 1"/>
       <DUE>2007-01-03T00:00:00</DUE>
       <QUANTITY>90</QUANTITY>
       <PRIORITY>1</PRIORITY>
    </DEMAND>
    <DEMAND NAME="Order 3 for product 1">
       <ITEM NAME="Product 1"/>
       <DUE>2007-01-27T00:00:00</DUE>
       <QUANTITY>90</QUANTITY>
       <PRIORITY>2</PRIORITY>
    </DEMAND>
  </DEMANDS>
</PLAN>
